<!-- # mysql-exercises INTERNET_TV -->
# mysql-練習 INTERNET_TV

MySQLの学習を行う上でインターネットテレビのデータベース作成を行った記録です。

![itv.png](https://gyazo.com/97d08d49090b74b16cf825350b332d2d.png)


<ol>

## <li>テーブル設計</li>

<details>
  <summary>a. テーブル：series</summary>

  <text><br>


|カラム名             |データ型        |NULL|キー      |初期値  |AUTO INCREMENT|
|:-:                  |:-:             |:-: |:-:       |:-:     |:-:           |
|series_id            |INT             |    |PRIMARY   |        |YES           |
|created_at           |DATETIME        |    |          |        |              |
|series_name          |VARCHAR(255)    |    |          |        |              |


  <br></text>

</details>
<br><details>
  <summary>b. テーブル：genre</summary>

  <text><br>


|カラム名             |データ型        |NULL|キー      |初期値  |AUTO INCREMENT|
|:-:                  |:-:             |:-: |:-:       |:-:     |:-:           |
|genre_id             |INT             |    |PRIMARY   |        |YES           |
|created_at           |DATETIME        |    |          |        |              |
|genre_name           |VARCHAR(255)    |    |          |        |              |


  <br></text>

</details>
<br><details>
  <summary>c. テーブル：season</summary>

  <text><br>


|カラム名             |データ型        |NULL|キー      |初期値  |AUTO INCREMENT|
|:-:                  |:-:             |:-: |:-:       |:-:     |:-:           |
|season_id            |INT             |    |PRIMARY   |        |YES           |
|created_at           |DATETIME        |    |          |        |              |
|season_name          |VARCHAR(255)    |    |          |        |              |


  <br></text>

</details>
<br><details>
  <summary>d. テーブル：program</summary>

  <text><br>


|カラム名             |データ型        |NULL|キー      |初期値  |AUTO INCREMENT|
|:-:                  |:-:             |:-: |:-:       |:-:     |:-:           |
|program_id           |INT             |    |PRIMARY   |        |YES           |
|created_at           |DATETIME        |    |          |        |              |
|program_title        |VARCHAR(255)    |    |          |        |              |
|description          |TEXT            |    |          |        |              |
|season_id            |INT             |    |          |        |              |
|main_genre_id        |INT             |    |          |        |              |

- 外部キー制約：season_id に対して season(season_id)、main_genre_id に対して genre(genre_id) から設定


  <br></text>

</details>
<br><details>
  <summary>e. テーブル：episode</summary>

  <text><br>


|カラム名             |データ型        |NULL|キー      |初期値  |AUTO INCREMENT|
|:-:                  |:-:             |:-: |:-:       |:-:     |:-:           |
|episode_id           |INT             |    |PRIMARY   |        |YES           |
|created_at           |DATETIME        |    |          |        |              |
|episode_title        |VARCHAR(255)    |    |          |        |              |
|description          |TEXT            |    |          |        |              |
|playtime             |INT             |    |          |        |              |
|on_air               |DATETIME        |    |          |        |              |
|views                |BIGINT          |    |          |0       |              |
|program_id           |INT             |    |          |        |              |

- 外部キー制約：program_id に対して program(program_id) から設定


  <br></text>

</details>
<br><details>
  <summary>f. テーブル：series_mapping</summary>

  <text><br>


|カラム名             |データ型        |NULL|キー      |初期値  |AUTO INCREMENT|
|:-:                  |:-:             |:-: |:-:       |:-:     |:-:           |
|series_mapping_id    |INT             |    |PRIMARY   |        |YES           |
|created_at           |DATETIME        |    |          |        |              |
|program_id           |INT             |    |          |        |              |
|series_id            |INT             |    |          |        |              |

- 外部キー制約：program_id に対して program(program_id)、series_id に対して series(series_id) から設定


  <br></text>

</details>
<br><details>
  <summary>g. テーブル：genre_mapping</summary>

  <text><br>


|カラム名             |データ型        |NULL|キー      |初期値  |AUTO INCREMENT|
|:-:                  |:-:             |:-: |:-:       |:-:     |:-:           |
|genre_mapping_id     |INT             |    |PRIMARY   |        |YES           |
|created_at           |DATETIME        |    |          |        |              |
|program_id           |INT             |    |          |        |              |
|genre_id             |INT             |    |          |        |              |

- 外部キー制約：program_id

 に対して program(program_id)、genre_id に対して genre(genre_id) から設定


  <br></text>

</details>
<br><details>
  <summary>h. テーブル：channel</summary>

  <text><br>


|カラム名             |データ型        |NULL|キー      |初期値  |AUTO INCREMENT|
|:-:                  |:-:             |:-: |:-:       |:-:     |:-:           |
|channel_id           |INT             |    |PRIMARY   |        |YES           |
|created_at           |DATETIME        |    |          |        |              |
|channel_name         |VARCHAR(255)    |    |          |        |              |


  <br></text>

</details>
<br><details>
  <summary>i. テーブル：schedule</summary>

  <text><br>


|カラム名             |データ型        |NULL|キー      |初期値  |AUTO INCREMENT|
|:-:                  |:-:             |:-: |:-:       |:-:     |:-:           |
|schedule_id          |INT             |    |PRIMARY   |        |YES           |
|created_at           |DATETIME        |    |          |        |              |
|channel_id           |INT             |    |          |        |              |
|start_time           |DATETIME        |    |          |        |              |
|end_time             |DATETIME        |    |          |        |              |

- 外部キー制約：channel_id に対して channel(channel_id) から設定


  <br></text>

</details>
<br><details>
  <summary>j. テーブル：metrics_marker_function</summary>

  <text><br>


|カラム名             |データ型        |NULL|キー      |初期値  |AUTO INCREMENT|
|:-:                  |:-:             |:-: |:-:       |:-:     |:-:           |
|metrics_marker_function_id|INT        |    |PRIMARY   |        |YES           |
|created_at           |DATETIME        |    |          |        |              |
|function_name        |VARCHAR(255)    |    |          |        |              |
|function_content     |TEXT            |    |          |        |              |


  <br></text>

</details>
<br><details>
  <summary>k. テーブル：broadcast</summary>

  <text><br>


|カラム名             |データ型        |NULL|キー      |初期値  |AUTO INCREMENT|
|:-:                  |:-:             |:-: |:-:       |:-:     |:-:           |
|broadcast_id         |INT             |    |PRIMARY   |        |YES           |
|created_at           |DATETIME        |    |          |        |              |
|episode_id           |INT             |    |          |        |              |
|schedule_id          |INT             |    |          |        |              |

- 外部キー制約：episode_id に対して episode(episode_id)、schedule_id に対して schedule(schedule_id) から設定


  <br></text>

</details>
<br><details>
  <summary>l. テーブル：broadcast_metrics</summary>

  <text><br>


|カラム名             |データ型        |NULL|キー      |初期値  |AUTO INCREMENT|
|:-:                  |:-:             |:-: |:-:       |:-:     |:-:           |
|broadcast_metrics_id |INT             |    |PRIMARY   |        |YES           |
|created_at           |DATETIME        |    |          |        |              |
|broadcast_id         |INT             |    |          |        |              |
|metrics_marker_function_id|INT        |    |          |        |              |
|metrics_value        |INT             |    |          |        |              |

- 外部キー制約：broadcast_id に対して broadcast(broadcast_id)、metrics_marker_function_id に対して metrics_marker_function(metrics_marker_function_id) から設定


  <br></text>

</details>
<br>


## <li>手順のドキュメント</li>

[データベースの設計と操作手順について](./data_add_doc.md)

## <li>データの抽出</li>

[抽出に使用するデータ - Google スプレッドシート](https://docs.google.com/spreadsheets/d/1kQTzJCZSyCHkZ1HDM9EBShIv1jDWvWagYlhEuvLtioI/edit?usp=sharing)

<details>
  <summary>a. エピソード視聴数トップ3のエピソードタイトルと視聴数</summary>

  <text><br>

```sql
SELECT e.episode_title, e.views
  FROM episode e
 ORDER BY e.views DESC
 LIMIT 3
;
```

| episode_title | views     |
|-|-|
| ep3           | 999946789 |
| ep14          | 999733455 |
| ep8           | 999537708 |


  <br></text>

</details>
<br>
<details>
  <summary>b. エピソード視聴数トップ3の番組タイトル、シーズン数、エピソード数、エピソードタイトル、視聴数</summary>

  <text><br>

```sql
SELECT p.program_title AS program_title
     , (
         SELECT COUNT(*)
           FROM program p2
          WHERE p2.season_id = p.season_id
       ) AS total_season
     , (
         SELECT COUNT(*)
           FROM episode e2 
          WHERE e2.program_id = e.program_id
       ) AS total_episode
     , (
         SELECT COUNT(*)+1
           FROM program p2
          WHERE p2.season_id = p.season_id AND p2.program_id < p.program_id
       ) AS nth_season
     , (
         SELECT COUNT(*)+1
           FROM episode e2 
          WHERE e2.program_id = e.program_id AND e2.episode_id < e.episode_id
       ) AS nth_episode
     , e.episode_title AS episode_tsitle
     , e.views AS view_Count
  FROM episode e
  JOIN program p ON e.program_id = p.program_id
 ORDER BY e.views DESC
 LIMIT 3
;
```

| program_title                             | total_season | total_episode | nth_season | nth_episode | episode_tsitle | view_Count |
|-------------------------------------------|--------------|---------------|------------|-------------|----------------|------------|
| 素晴らしき世界 シーズン11                 |           13 |            10 |         11 |           3 | ep3            |  999946789 |
| 夢見るピアノ シーズン2                    |           14 |            14 |          2 |          14 | ep14           |  999733455 |
| スイートドリームス シーズン2              |            6 |             9 |          2 |           8 | ep8            |  999537708 |

<!-- ```
mysql> SELECT * FROM program WHERE program_title LIKE '%夢見るピアノ シーズン%';
+------------+---------------------+-----------------------------------+-----------------------+-----------+---------------+
| program_id | created_at          | program_title                     | description           | season_id | main_genre_id |
+------------+---------------------+-----------------------------------+-----------------------+-----------+---------------+
|        243 | 2023-05-18 13:07:15 | 夢見るピアノ シーズン1            | 番組説明です。        |        28 |            22 |
|        244 | 2023-05-18 13:07:15 | 夢見るピアノ シーズン2            | 番組説明です。        |        28 |            22 |
|        245 | 2023-05-18 13:07:15 | 夢見るピアノ シーズン3            | 番組説明です。        |        28 |            22 |
|        246 | 2023-05-18 13:07:15 | 夢見るピアノ シーズン4            | 番組説明です。        |        28 |            22 |
|        247 | 2023-05-18 13:07:15 | 夢見るピアノ シーズン5            | 番組説明です。        |        28 |            22 |
|        248 | 2023-05-18 13:07:15 | 夢見るピアノ シーズン6            | 番組説明です。        |        28 |            22 |
|        249 | 2023-05-18 13:07:15 | 夢見るピアノ シーズン7            | 番組説明です。        |        28 |            22 |
|        250 | 2023-05-18 13:07:15 | 夢見るピアノ シーズン8            | 番組説明です。        |        28 |            22 |
|        251 | 2023-05-18 13:07:15 | 夢見るピアノ シーズン9            | 番組説明です。        |        28 |            22 |
|        252 | 2023-05-18 13:07:15 | 夢見るピアノ シーズン10           | 番組説明です。        |        28 |            22 |
|        253 | 2023-05-18 13:07:15 | 夢見るピアノ シーズン11           | 番組説明です。        |        28 |            22 |
|        254 | 2023-05-18 13:07:15 | 夢見るピアノ シーズン12           | 番組説明です。        |        28 |            22 |
|        255 | 2023-05-18 13:07:15 | 夢見るピアノ シーズン13           | 番組説明です。        |        28 |            22 |
|        256 | 2023-05-18 13:07:15 | 夢見るピアノ シーズン14           | 番組説明です。        |        28 |            22 |
+------------+---------------------+-----------------------------------+-----------------------+-----------+---------------+
``` -->

  <br></text>

</details>
<br>
<details>
  <summary>c. 本日放送される全ての番組に対して、チャンネル名、放送開始時刻(日付+時間)、放送終了時刻、シーズン数、エピソード数、エピソードタイトル、エピソード詳細</summary>

  <text><br>

```sql
SELECT ch.channel_name
     , s.start_time
     , TIME(s.end_time) AS end_time
     , (
         SELECT COUNT(*)+1
           FROM program p2
          WHERE p2.season_id = p.season_id AND p2.program_id < p.program_id
       ) AS nth_season
     , (
         SELECT COUNT(*)+1
           FROM episode e2 
          WHERE e2.program_id = e.program_id AND e2.episode_id < e.episode_id
       ) AS nth_episode
     , e.episode_title
     , e.description
  FROM channel ch
 INNER JOIN schedule s ON s.channel_id = ch.channel_id
 INNER JOIN broadcast b ON b.schedule_id = s.schedule_id
 INNER JOIN episode e ON e.episode_id = b.episode_id
 INNER JOIN program p ON p.program_id = e.program_id
 WHERE DATE(s.start_time) = CURDATE()
;

```

| channel_name | start_time          | end_time | nth_season | nth_episode | episode_title | description                    |
| ------------ | ------------------- | -------- | ---------- | ----------- | ------------- | ------------------------------ |
| ペット       | 2023-05-19 00:00:00 | 01:00:00 |         14 |           4 | ep4           | エピソード説明です。           |
| ドラマ1      | 2023-05-19 01:00:00 | 02:00:00 |          1 |           4 | ep4           | エピソード説明です。           |
| ドラマ2      | 2023-05-19 02:00:00 | 03:00:00 |          2 |           4 | ep4           | エピソード説明です。           |
| アニメ1      | 2023-05-19 03:00:00 | 04:00:00 |          3 |           4 | ep4           | エピソード説明です。           |
| アニメ2      | 2023-05-19 04:00:00 | 05:00:00 |          4 |           4 | ep4           | エピソード説明です。           |
| スポーツ     | 2023-05-19 05:00:00 | 06:00:00 |          5 |           4 | ep4           | エピソード説明です。           |
| ペット       | 2023-05-19 06:00:00 | 07:00:00 |          6 |           4 | ep4           | エピソード説明です。           |
| ドラマ1      | 2023-05-19 07:00:00 | 08:00:00 |          7 |           4 | ep4           | エピソード説明です。           |
| ドラマ2      | 2023-05-19 08:00:00 | 09:00:00 |          8 |           4 | ep4           | エピソード説明です。           |
| アニメ1      | 2023-05-19 09:00:00 | 10:00:00 |          9 |           4 | ep4           | エピソード説明です。           |
| ドラマ2      | 2023-05-19 14:00:00 | 15:00:00 |          3 |           4 | ep4           | エピソード説明です。           |
| アニメ1      | 2023-05-19 15:00:00 | 16:00:00 |          4 |           4 | ep4           | エピソード説明です。           |
| アニメ2      | 2023-05-19 16:00:00 | 17:00:00 |          5 |           4 | ep4           | エピソード説明です。           |
| スポーツ     | 2023-05-19 17:00:00 | 18:00:00 |          6 |           4 | ep4           | エピソード説明です。           |
| ペット       | 2023-05-19 18:00:00 | 19:00:00 |          7 |           4 | ep4           | エピソード説明です。           |
| ドラマ1      | 2023-05-19 19:00:00 | 20:00:00 |          8 |           4 | ep4           | エピソード説明です。           |
| ドラマ2      | 2023-05-19 20:00:00 | 21:00:00 |          9 |           4 | ep4           | エピソード説明です。           |
| アニメ1      | 2023-05-19 21:00:00 | 22:00:00 |         10 |           4 | ep4           | エピソード説明です。           |
| アニメ2      | 2023-05-19 22:00:00 | 23:00:00 |         11 |           4 | ep4           | エピソード説明です。           |
| スポーツ     | 2023-05-19 23:00:00 | 00:00:00 |         12 |           4 | ep4           | エピソード説明です。           |
| ペット       | 2023-05-19 00:00:00 | 01:00:00 |          5 |           3 | ep3           | エピソード説明です。           |
| ドラマ1      | 2023-05-19 01:00:00 | 02:00:00 |          6 |           3 | ep3           | エピソード説明です。           |
| ドラマ2      | 2023-05-19 02:00:00 | 03:00:00 |          7 |           3 | ep3           | エピソード説明です。           |
| アニメ1      | 2023-05-19 03:00:00 | 04:00:00 |          1 |           3 | ep3           | エピソード説明です。           |
| アニメ2      | 2023-05-19 04:00:00 | 05:00:00 |          2 |           3 | ep3           | エピソード説明です。           |
| スポーツ     | 2023-05-19 05:00:00 | 06:00:00 |          3 |           3 | ep3           | エピソード説明です。           |
| ペット       | 2023-05-19 06:00:00 | 07:00:00 |          4 |           3 | ep3           | エピソード説明です。           |
| アニメ1      | 2023-05-19 09:00:00 | 10:00:00 |          7 |           3 | ep3           | エピソード説明です。           |
| アニメ2      | 2023-05-19 10:00:00 | 11:00:00 |          8 |           3 | ep3           | エピソード説明です。           |
| スポーツ     | 2023-05-19 11:00:00 | 12:00:00 |          9 |           3 | ep3           | エピソード説明です。           |
| ペット       | 2023-05-19 12:00:00 | 13:00:00 |         10 |           3 | ep3           | エピソード説明です。           |
| ドラマ1      | 2023-05-19 13:00:00 | 14:00:00 |         11 |           3 | ep3           | エピソード説明です。           |
| ドラマ2      | 2023-05-19 14:00:00 | 15:00:00 |         12 |           3 | ep3           | エピソード説明です。           |
| アニメ1      | 2023-05-19 15:00:00 | 16:00:00 |         13 |           3 | ep3           | エピソード説明です。           |
| アニメ2      | 2023-05-19 16:00:00 | 17:00:00 |         14 |           3 | ep3           | エピソード説明です。           |
| スポーツ     | 2023-05-19 17:00:00 | 18:00:00 |          1 |           3 | ep3           | エピソード説明です。           |
| ペット       | 2023-05-19 18:00:00 | 19:00:00 |          2 |           3 | ep3           | エピソード説明です。           |
| ドラマ1      | 2023-05-19 19:00:00 | 20:00:00 |          3 |           3 | ep3           | エピソード説明です。           |
| ドラマ2      | 2023-05-19 20:00:00 | 21:00:00 |          4 |           3 | ep3           | エピソード説明です。           |
| アニメ1      | 2023-05-19 21:00:00 | 22:00:00 |          5 |           3 | ep3           | エピソード説明です。           |
| アニメ2      | 2023-05-19 22:00:00 | 23:00:00 |          6 |           3 | ep3           | エピソード説明です。           |
| スポーツ     | 2023-05-19 23:00:00 | 00:00:00 |          7 |           3 | ep3           | エピソード説明です。           |
| ペット       | 2023-05-19 00:00:00 | 01:00:00 |         16 |           2 | ep2           | エピソード説明です。           |
| ドラマ1      | 2023-05-19 01:00:00 | 02:00:00 |         17 |           2 | ep2           | エピソード説明です。           |
| ドラマ2      | 2023-05-19 02:00:00 | 03:00:00 |          1 |           2 | ep2           | エピソード説明です。           |
| アニメ1      | 2023-05-19 03:00:00 | 04:00:00 |          2 |           2 | ep2           | エピソード説明です。           |
| アニメ2      | 2023-05-19 04:00:00 | 05:00:00 |          3 |           2 | ep2           | エピソード説明です。           |
| スポーツ     | 2023-05-19 05:00:00 | 06:00:00 |          4 |           2 | ep2           | エピソード説明です。           |
| ペット       | 2023-05-19 06:00:00 | 07:00:00 |          5 |           2 | ep2           | エピソード説明です。           |
| ドラマ1      | 2023-05-19 07:00:00 | 08:00:00 |          6 |           2 | ep2           | エピソード説明です。           |
| ドラマ2      | 2023-05-19 08:00:00 | 09:00:00 |          7 |           2 | ep2           | エピソード説明です。           |
| アニメ1      | 2023-05-19 09:00:00 | 10:00:00 |          8 |           2 | ep2           | エピソード説明です。           |
| アニメ2      | 2023-05-19 10:00:00 | 11:00:00 |          1 |           2 | ep2           | エピソード説明です。           |
| スポーツ     | 2023-05-19 11:00:00 | 12:00:00 |          1 |           2 | ep2           | エピソード説明です。           |
| ペット       | 2023-05-19 12:00:00 | 13:00:00 |          2 |           2 | ep2           | エピソード説明です。           |
| ドラマ1      | 2023-05-19 13:00:00 | 14:00:00 |          3 |           2 | ep2           | エピソード説明です。           |
| ドラマ2      | 2023-05-19 14:00:00 | 15:00:00 |          4 |           2 | ep2           | エピソード説明です。           |
| アニメ1      | 2023-05-19 15:00:00 | 16:00:00 |          5 |           2 | ep2           | エピソード説明です。           |
| アニメ2      | 2023-05-19 16:00:00 | 17:00:00 |          6 |           2 | ep2           | エピソード説明です。           |
| スポーツ     | 2023-05-19 17:00:00 | 18:00:00 |          7 |           2 | ep2           | エピソード説明です。           |
| ペット       | 2023-05-19 18:00:00 | 19:00:00 |          8 |           2 | ep2           | エピソード説明です。           |
| ドラマ1      | 2023-05-19 19:00:00 | 20:00:00 |          9 |           2 | ep2           | エピソード説明です。           |
| ドラマ2      | 2023-05-19 20:00:00 | 21:00:00 |         10 |           2 | ep2           | エピソード説明です。           |
| アニメ1      | 2023-05-19 21:00:00 | 22:00:00 |          1 |           2 | ep2           | エピソード説明です。           |
| アニメ2      | 2023-05-19 22:00:00 | 23:00:00 |          2 |           2 | ep2           | エピソード説明です。           |
| スポーツ     | 2023-05-19 23:00:00 | 00:00:00 |          3 |           2 | ep2           | エピソード説明です。           |



  <br></text>

</details>
<br>
<details>
  <summary>d. ドラマのチャンネルに対して、放送開始時刻、放送終了時刻、シーズン数、エピソード数、エピソードタイトル、エピソード詳細を本日から一週間分取得</summary>

  <text><br>

```sql
SELECT * FROM channel WHERE channel_name LIKE 'ドラマ%';

```

| channel_id | created_at          | channel_name |
| ---------- | ------------------- | ------------ |
|          1 | 2023-05-18 13:07:18 | ドラマ1      |
|          2 | 2023-05-18 13:07:18 | ドラマ2      |


```sql

SELECT s.start_time
     , s.end_time
     , (
         SELECT COUNT(*)+1
           FROM program p2
          WHERE p2.season_id = p.season_id AND p2.program_id < p.program_id
       ) AS nth_season
     , (
         SELECT COUNT(*)+1
           FROM episode e2 
          WHERE e2.program_id = e.program_id AND e2.episode_id < e.episode_id
       ) AS nth_episode
     , e.episode_title
     , e.description
  FROM channel ch
 INNER JOIN schedule s ON s.channel_id = ch.channel_id
 INNER JOIN broadcast b ON b.schedule_id = s.schedule_id
 INNER JOIN episode e ON e.episode_id = b.episode_id
 INNER JOIN program p ON p.program_id = e.program_id
 WHERE (s.channel_id BETWEEN 1 AND 2)
   AND s.start_time BETWEEN CURDATE() AND DATE_ADD(CURDATE(), INTERVAL 7 DAY)
;
```

| start_time          | end_time            | nth_season | nth_episode | episode_title         | description                    |
| ------------------- | ------------------- | ---------- | ----------- | --------------------- | ------------------------------ |
| 2023-05-23 07:00:00 | 2023-05-23 08:00:00 |          2 |           5 | 大自然の美しさ        | エピソード説明です。           |
| 2023-05-24 01:00:00 | 2023-05-24 02:00:00 |          5 |           5 | ep5                   | エピソード説明です。           |
| 2023-05-24 07:00:00 | 2023-05-24 08:00:00 |         11 |           5 | ep5                   | エピソード説明です。           |
| 2023-05-25 01:00:00 | 2023-05-25 02:00:00 |         10 |           5 | ep5                   | エピソード説明です。           |
| 2023-05-25 07:00:00 | 2023-05-25 08:00:00 |          3 |           5 | ep5                   | エピソード説明です。           |
| 2023-05-25 19:00:00 | 2023-05-25 20:00:00 |          9 |           5 | ep5                   | エピソード説明です。           |
| 2023-05-19 01:00:00 | 2023-05-19 02:00:00 |          1 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-19 07:00:00 | 2023-05-19 08:00:00 |          7 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-19 19:00:00 | 2023-05-19 20:00:00 |          8 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-20 01:00:00 | 2023-05-20 02:00:00 |         14 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-20 07:00:00 | 2023-05-20 08:00:00 |          2 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-20 13:00:00 | 2023-05-20 14:00:00 |          8 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-20 19:00:00 | 2023-05-20 20:00:00 |         14 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-21 01:00:00 | 2023-05-21 02:00:00 |          6 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-21 07:00:00 | 2023-05-21 08:00:00 |          1 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-21 13:00:00 | 2023-05-21 14:00:00 |          7 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-21 19:00:00 | 2023-05-21 20:00:00 |         13 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-22 07:00:00 | 2023-05-22 08:00:00 |          2 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-22 13:00:00 | 2023-05-22 14:00:00 |          8 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-22 19:00:00 | 2023-05-22 20:00:00 |          5 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-23 01:00:00 | 2023-05-23 02:00:00 |         11 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-23 07:00:00 | 2023-05-23 08:00:00 |         17 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-23 19:00:00 | 2023-05-23 20:00:00 |          9 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-24 01:00:00 | 2023-05-24 02:00:00 |         15 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-24 07:00:00 | 2023-05-24 08:00:00 |          4 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-24 13:00:00 | 2023-05-24 14:00:00 |          2 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-24 19:00:00 | 2023-05-24 20:00:00 |          2 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-25 01:00:00 | 2023-05-25 02:00:00 |          8 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-25 07:00:00 | 2023-05-25 08:00:00 |         14 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-25 13:00:00 | 2023-05-25 14:00:00 |          1 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-25 19:00:00 | 2023-05-25 20:00:00 |          7 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-19 01:00:00 | 2023-05-19 02:00:00 |          6 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-19 13:00:00 | 2023-05-19 14:00:00 |         11 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-19 19:00:00 | 2023-05-19 20:00:00 |          3 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-20 01:00:00 | 2023-05-20 02:00:00 |          9 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-20 13:00:00 | 2023-05-20 14:00:00 |          7 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-21 01:00:00 | 2023-05-21 02:00:00 |          8 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-21 07:00:00 | 2023-05-21 08:00:00 |          2 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-21 13:00:00 | 2023-05-21 14:00:00 |          8 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-22 01:00:00 | 2023-05-22 02:00:00 |         12 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-22 07:00:00 | 2023-05-22 08:00:00 |          6 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-22 13:00:00 | 2023-05-22 14:00:00 |          3 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-23 01:00:00 | 2023-05-23 02:00:00 |          2 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-23 07:00:00 | 2023-05-23 08:00:00 |          6 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-23 13:00:00 | 2023-05-23 14:00:00 |         12 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-23 19:00:00 | 2023-05-23 20:00:00 |          2 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-24 01:00:00 | 2023-05-24 02:00:00 |          8 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-24 13:00:00 | 2023-05-24 14:00:00 |          1 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-24 19:00:00 | 2023-05-24 20:00:00 |          7 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-25 01:00:00 | 2023-05-25 02:00:00 |          4 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-25 07:00:00 | 2023-05-25 08:00:00 |         10 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-25 19:00:00 | 2023-05-25 20:00:00 |         11 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-19 01:00:00 | 2023-05-19 02:00:00 |         17 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-19 07:00:00 | 2023-05-19 08:00:00 |          6 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-19 13:00:00 | 2023-05-19 14:00:00 |          3 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-19 19:00:00 | 2023-05-19 20:00:00 |          9 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-20 01:00:00 | 2023-05-20 02:00:00 |          5 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-20 07:00:00 | 2023-05-20 08:00:00 |         11 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-20 13:00:00 | 2023-05-20 14:00:00 |         17 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-20 19:00:00 | 2023-05-20 20:00:00 |          5 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-21 01:00:00 | 2023-05-21 02:00:00 |          6 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-21 07:00:00 | 2023-05-21 08:00:00 |         12 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-21 13:00:00 | 2023-05-21 14:00:00 |          1 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-21 19:00:00 | 2023-05-21 20:00:00 |          7 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-22 01:00:00 | 2023-05-22 02:00:00 |         13 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-22 13:00:00 | 2023-05-22 14:00:00 |          2 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-22 19:00:00 | 2023-05-22 20:00:00 |          8 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-23 01:00:00 | 2023-05-23 02:00:00 |         14 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-23 07:00:00 | 2023-05-23 08:00:00 |          4 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-23 13:00:00 | 2023-05-23 14:00:00 |         10 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-23 19:00:00 | 2023-05-23 20:00:00 |         16 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-24 01:00:00 | 2023-05-24 02:00:00 |          3 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-24 07:00:00 | 2023-05-24 08:00:00 |          5 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-24 13:00:00 | 2023-05-24 14:00:00 |         11 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-24 19:00:00 | 2023-05-24 20:00:00 |         17 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-25 01:00:00 | 2023-05-25 02:00:00 |          6 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-25 07:00:00 | 2023-05-25 08:00:00 |          6 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-25 13:00:00 | 2023-05-25 14:00:00 |          6 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-23 08:00:00 | 2023-05-23 09:00:00 |          3 |           5 | 未来の食事            | エピソード説明です。           |
| 2023-05-23 14:00:00 | 2023-05-23 15:00:00 |          9 |           5 | ep5                   | エピソード説明です。           |
| 2023-05-24 02:00:00 | 2023-05-24 03:00:00 |          6 |           5 | ep5                   | エピソード説明です。           |
| 2023-05-24 14:00:00 | 2023-05-24 15:00:00 |         18 |           5 | ep5                   | エピソード説明です。           |
| 2023-05-25 02:00:00 | 2023-05-25 03:00:00 |         11 |           5 | ep5                   | エピソード説明です。           |
| 2023-05-25 08:00:00 | 2023-05-25 09:00:00 |          4 |           5 | ep5                   | エピソード説明です。           |
| 2023-05-25 20:00:00 | 2023-05-25 21:00:00 |         10 |           5 | ep5                   | エピソード説明です。           |
| 2023-05-19 02:00:00 | 2023-05-19 03:00:00 |          2 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-19 08:00:00 | 2023-05-19 09:00:00 |          8 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-19 14:00:00 | 2023-05-19 15:00:00 |          3 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-19 20:00:00 | 2023-05-19 21:00:00 |          9 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-20 02:00:00 | 2023-05-20 03:00:00 |         15 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-20 08:00:00 | 2023-05-20 09:00:00 |          3 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-20 20:00:00 | 2023-05-20 21:00:00 |          1 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-21 02:00:00 | 2023-05-21 03:00:00 |          7 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-21 08:00:00 | 2023-05-21 09:00:00 |          2 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-21 14:00:00 | 2023-05-21 15:00:00 |          8 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-21 20:00:00 | 2023-05-21 21:00:00 |         14 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-22 02:00:00 | 2023-05-22 03:00:00 |          3 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-22 08:00:00 | 2023-05-22 09:00:00 |          3 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-22 14:00:00 | 2023-05-22 15:00:00 |          1 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-22 20:00:00 | 2023-05-22 21:00:00 |          6 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-23 08:00:00 | 2023-05-23 09:00:00 |          1 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-23 14:00:00 | 2023-05-23 15:00:00 |          4 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-24 02:00:00 | 2023-05-24 03:00:00 |         16 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-24 08:00:00 | 2023-05-24 09:00:00 |          5 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-24 14:00:00 | 2023-05-24 15:00:00 |          3 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-24 20:00:00 | 2023-05-24 21:00:00 |          3 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-25 02:00:00 | 2023-05-25 03:00:00 |          9 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-25 08:00:00 | 2023-05-25 09:00:00 |         15 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-25 14:00:00 | 2023-05-25 15:00:00 |          2 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-25 20:00:00 | 2023-05-25 21:00:00 |          1 |           4 | ep4                   | エピソード説明です。           |
| 2023-05-19 02:00:00 | 2023-05-19 03:00:00 |          7 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-19 14:00:00 | 2023-05-19 15:00:00 |         12 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-19 20:00:00 | 2023-05-19 21:00:00 |          4 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-20 02:00:00 | 2023-05-20 03:00:00 |         10 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-20 08:00:00 | 2023-05-20 09:00:00 |          2 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-20 14:00:00 | 2023-05-20 15:00:00 |          8 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-20 20:00:00 | 2023-05-20 21:00:00 |          3 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-21 02:00:00 | 2023-05-21 03:00:00 |          9 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-21 14:00:00 | 2023-05-21 15:00:00 |          1 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-21 20:00:00 | 2023-05-21 21:00:00 |          7 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-22 02:00:00 | 2023-05-22 03:00:00 |          1 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-22 08:00:00 | 2023-05-22 09:00:00 |          7 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-22 20:00:00 | 2023-05-22 21:00:00 |          6 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-23 02:00:00 | 2023-05-23 03:00:00 |          1 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-23 08:00:00 | 2023-05-23 09:00:00 |          7 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-23 14:00:00 | 2023-05-23 15:00:00 |         13 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-23 20:00:00 | 2023-05-23 21:00:00 |          3 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-24 02:00:00 | 2023-05-24 03:00:00 |          9 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-24 08:00:00 | 2023-05-24 09:00:00 |         15 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-24 14:00:00 | 2023-05-24 15:00:00 |          2 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-24 20:00:00 | 2023-05-24 21:00:00 |          8 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-25 02:00:00 | 2023-05-25 03:00:00 |          5 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-25 08:00:00 | 2023-05-25 09:00:00 |         11 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-25 14:00:00 | 2023-05-25 15:00:00 |          6 |           3 | ep3                   | エピソード説明です。           |
| 2023-05-19 02:00:00 | 2023-05-19 03:00:00 |          1 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-19 08:00:00 | 2023-05-19 09:00:00 |          7 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-19 14:00:00 | 2023-05-19 15:00:00 |          4 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-19 20:00:00 | 2023-05-19 21:00:00 |         10 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-20 02:00:00 | 2023-05-20 03:00:00 |          6 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-20 14:00:00 | 2023-05-20 15:00:00 |         18 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-20 20:00:00 | 2023-05-20 21:00:00 |          1 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-21 02:00:00 | 2023-05-21 03:00:00 |          7 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-21 08:00:00 | 2023-05-21 09:00:00 |         13 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-21 14:00:00 | 2023-05-21 15:00:00 |          2 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-21 20:00:00 | 2023-05-21 21:00:00 |          8 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-22 02:00:00 | 2023-05-22 03:00:00 |         14 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-22 08:00:00 | 2023-05-22 09:00:00 |          3 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-22 14:00:00 | 2023-05-22 15:00:00 |          3 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-22 20:00:00 | 2023-05-22 21:00:00 |          9 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-23 02:00:00 | 2023-05-23 03:00:00 |         15 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-23 08:00:00 | 2023-05-23 09:00:00 |          5 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-23 14:00:00 | 2023-05-23 15:00:00 |         11 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-23 20:00:00 | 2023-05-23 21:00:00 |         17 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-24 02:00:00 | 2023-05-24 03:00:00 |          4 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-24 08:00:00 | 2023-05-24 09:00:00 |          6 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-24 14:00:00 | 2023-05-24 15:00:00 |         12 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-24 20:00:00 | 2023-05-24 21:00:00 |          1 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-25 02:00:00 | 2023-05-25 03:00:00 |          1 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-25 08:00:00 | 2023-05-25 09:00:00 |          1 |           2 | ep2                   | エピソード説明です。           |
| 2023-05-25 14:00:00 | 2023-05-25 15:00:00 |          7 |           2 | ep2                   | エピソード説明です。           |


  <br></text>

</details>
<br>
<details>
  <summary>e. 直近一週間で最も見られた番組が知りたい。直近一週間に放送された番組の中で、エピソード視聴数合計トップ2の番組に対して、番組タイトル、視聴数を取得</summary>

  <text><br>

```sql
SELECT p.program_title
     , SUM(bm.metrics_value) AS total_views
  FROM broadcast b
  JOIN schedule s ON s.schedule_id = b.schedule_id
  JOIN episode e ON e.episode_id = b.episode_id
  JOIN program p ON p.program_id = e.program_id
  JOIN broadcast_metrics bm ON bm.broadcast_id = b.broadcast_id
 WHERE s.start_time >= DATE_SUB(NOW(), INTERVAL 1 WEEK)
 GROUP BY p.program_title
 ORDER BY total_views DESC
 LIMIT 2
;
```

| program_title                           | total_views |
| --------------------------------------- | ----------- |
| ローズガーデン シーズン12               |  1173632442 |
| さわやかウィンド シーズン16             |  1170616274 |


  <br></text>

</details>
<br>
<details>
  <summary>f. ジャンルごとの番組の視聴数ランキングを知りたい。番組の視聴数ランキングはエピソードの平均視聴数ランキングとする。ジャンルごとに視聴数トップの番組に対して、ジャンル名、番組タイトル、エピソード平均視聴数を取得</summary>

  <text><br>

```sql
SELECT genre_name
     , ranking
     , program_title
     , average_views
  FROM (
        SELECT g.genre_name
             , p.program_title
             , AVG(e.views) AS average_views
             , ROW_NUMBER() OVER (PARTITION BY g.genre_name ORDER BY AVG(e.views) DESC) as ranking
          FROM genre g
          JOIN program p ON p.main_genre_id = g.genre_id
          JOIN episode e ON e.program_id = p.program_id
         GROUP BY g.genre_name
                , p.program_title
       ) t
 WHERE ranking <= 10
 ORDER BY genre_name DESC
        , ranking ASC
 ;

```


| genre_name               | ranking | program_title                                                | average_views  |
| ------------------------ | ------- | ------------------------------------------------------------ | -------------- |
| 音楽                     |       1 | レインボーダンス シーズン11                                  | 857693335.0000 |
| 音楽                     |       2 | レインボーダンス シーズン14                                  | 807757114.5000 |
| 音楽                     |       3 | サンセットドライブ シーズン3                                 | 801466594.6667 |
| 音楽                     |       4 | 炎のダンス シーズン5                                         | 800475467.5000 |
| 音楽                     |       5 | サンセットドライブ シーズン2                                 | 767683054.3333 |
| 音楽                     |       6 | 夢見るピアノ シーズン6                                       | 728245458.5000 |
| 音楽                     |       7 | さわやかウィンド シーズン16                                  | 727323720.5263 |
| 音楽                     |       8 | 音楽の時間 シーズン2                                         | 695095058.5000 |
| 音楽                     |       9 | レインボーダンス シーズン10                                  | 675278181.8333 |
| 音楽                     |      10 | 炎のダンス シーズン11                                        | 673487714.5000 |
| 映画                     |       1 | ミステリーナイト シーズン7                                   | 695221014.4444 |
| 映画                     |       2 | スリリングな夜 シーズン2                                     | 673020275.5000 |
| 映画                     |       3 | ミステリーナイト シーズン6                                   | 650265613.2222 |
| 映画                     |       4 | スリリングな夜 シーズン1                                     | 648631644.0000 |
| 映画                     |       5 | スリリングな夜 シーズン6                                     | 594958436.6111 |
| 映画                     |       6 | ミステリーナイト シーズン9                                   | 563515713.6000 |
| 映画                     |       7 | スリリングな夜 シーズン7                                     | 546085275.7500 |
| 映画                     |       8 | ナイトウォーカーズ シーズン4                                 | 531003354.0000 |
| 映画                     |       9 | ナイトウォーカーズ シーズン3                                 | 525001627.2500 |
| 映画                     |      10 | ミステリーナイト シーズン8                                   | 511925612.0588 |
| 新着                     |       1 | フレッシュモーニング シーズン7                               | 617614195.5294 |
| 新着                     |       2 | フレッシュモーニング シーズン5                               | 588191385.7500 |
| 新着                     |       3 | フレッシュモーニング シーズン4                               | 569048028.4000 |
| 新着                     |       4 | フレッシュモーニング シーズン2                               | 498411379.8333 |
| 新着                     |       5 | フレッシュモーニング シーズン3                               | 489015541.0556 |
| 新着                     |       6 | フレッシュモーニング シーズン9                               | 442845431.3500 |
| 新着                     |       7 | フレッシュモーニング シーズン1                               | 415441230.6667 |
| 新着                     |       8 | フレッシュモーニング シーズン8                               | 397257997.7500 |
| 新着                     |       9 | フレッシュモーニング シーズン6                               | 240719596.0000 |
| 恋愛番組                 |       1 | ロマンティック・エンカウンター シーズン6                     | 716045335.0000 |
| 恋愛番組                 |       2 | ロマンティック・エンカウンター シーズン3                     | 610903190.5000 |
| 恋愛番組                 |       3 | 恋するキッチン シーズン3                                     | 568228518.1000 |
| 恋愛番組                 |       4 | ロマンティック・エンカウンター シーズン11                    | 562278379.0769 |
| 恋愛番組                 |       5 | 恋するキッチン シーズン1                                     | 546865005.3125 |
| 恋愛番組                 |       6 | ロマンティック・エンカウンター シーズン7                     | 534264295.4286 |
| 恋愛番組                 |       7 | 恋するキッチン シーズン6                                     | 521544325.1667 |
| 恋愛番組                 |       8 | 恋するキッチン シーズン5                                     | 517078726.0667 |
| 恋愛番組                 |       9 | ロマンティック・エンカウンター シーズン2                     | 514446474.0000 |
| 恋愛番組                 |      10 | ロマンティック・エンカウンター シーズン10                    | 494886326.5000 |
| バラエティ               |       1 | お笑いチャンピオン シーズン2                                 | 740906567.2000 |
| バラエティ               |       2 | スパイシーライフ シーズン6                                   | 642590714.3333 |
| バラエティ               |       3 | フレンズ・フォーエバー シーズン1                             | 614522135.0000 |
| バラエティ               |       4 | ハッピーデイズ シーズン3                                     | 613781580.0000 |
| バラエティ               |       5 | ミッドナイト・トーク シーズン10                              | 609131504.4615 |
| バラエティ               |       6 | お笑いチャンピオン シーズン4                                 | 608804699.0833 |
| バラエティ               |       7 | スパイシーライフ シーズン7                                   | 578086907.0667 |
| バラエティ               |       8 | フレンズ・フォーエバー シーズン3                             | 567287139.0000 |
| バラエティ               |       9 | フレンズ・フォーエバー シーズン4                             | 554908686.9286 |
| バラエティ               |      10 | お笑いチャンピオン シーズン1                                 | 548414067.5556 |
| ニュース                 |       1 | グローバルニュース シーズン4                                 | 578502118.4118 |
| ニュース                 |       2 | グローバルニュース シーズン2                                 | 564031312.3333 |
| ニュース                 |       3 | グローバルニュース シーズン3                                 | 397345421.0000 |
| ニュース                 |       4 | グローバルニュース シーズン1                                 | 377409006.8182 |
| ドラマ                   |       1 | ハイテク探偵団 シーズン16                                    | 956717698.0000 |
| ドラマ                   |       2 | ハートフルストーリー シーズン10                              | 887981746.6667 |
| ドラマ                   |       3 | ドリームキャッチャー シーズン2                               | 870206195.5000 |
| ドラマ                   |       4 | ローズガーデン シーズン2                                     | 770787525.5000 |
| ドラマ                   |       5 | ローズガーデン シーズン4                                     | 751720633.1250 |
| ドラマ                   |       6 | スパークリング・モーメント シーズン5                         | 750075691.5000 |
| ドラマ                   |       7 | フラワーガーデン シーズン1                                   | 744993725.4000 |
| ドラマ                   |       8 | フレンドリータウン シーズン10                                | 737650186.0000 |
| ドラマ                   |       9 | 風を追いかけて シーズン9                                     | 727804170.2222 |
| ドラマ                   |      10 | 素晴らしき世界 シーズン7                                     | 717849677.3333 |
| ドキュメンタリー         |       1 | シークレット・レシピ シーズン14                              | 931908047.0000 |
| ドキュメンタリー         |       2 | 未来予想図 シーズン7                                         | 780290968.0000 |
| ドキュメンタリー         |       3 | シークレット・レシピ シーズン7                               | 698188319.0000 |
| ドキュメンタリー         |       4 | シークレット・レシピ シーズン8                               | 680850481.1000 |
| ドキュメンタリー         |       5 | 都市の風景 シーズン7                                         | 677903183.0000 |
| ドキュメンタリー         |       6 | 都市の風景 シーズン2                                         | 673954014.0000 |
| ドキュメンタリー         |       7 | 都市の風景 シーズン13                                        | 646497200.4000 |
| ドキュメンタリー         |       8 | おいしいレシピ シーズン5                                     | 638954957.0000 |
| ドキュメンタリー         |       9 | 未来予想図 シーズン3                                         | 630174397.2500 |
| ドキュメンタリー         |      10 | 都市の風景 シーズン5                                         | 609248787.2500 |
| スポーツ                 |       1 | パワフルスポーツ シーズン4                                   | 680125999.0000 |
| スポーツ                 |       2 | パワフルスポーツ シーズン1                                   | 578538721.0909 |
| スポーツ                 |       3 | パワフルスポーツ シーズン5                                   | 575928185.8000 |
| スポーツ                 |       4 | パワフルスポーツ シーズン2                                   | 480081879.5385 |
| スポーツ                 |       5 | パワフルスポーツ シーズン7                                   | 468778978.9444 |
| スポーツ                 |       6 | パワフルスポーツ シーズン3                                   | 452997741.2222 |
| スポーツ                 |       7 | パワフルスポーツ シーズン6                                   | 428608764.1429 |
| アニメ                   |       1 | 密着！アイドル生活 シーズン12                                | 851843306.5000 |
| アニメ                   |       2 | 密着！アイドル生活 シーズン13                                | 721893326.8571 |
| アニメ                   |       3 | 密着！アイドル生活 シーズン17                                | 688111375.0000 |
| アニメ                   |       4 | 密着！アイドル生活 シーズン3                                 | 612274856.5000 |
| アニメ                   |       5 | 密着！アイドル生活 シーズン15                                | 584393422.1429 |
| アニメ                   |       6 | 密着！アイドル生活 シーズン6                                 | 560546364.1000 |
| アニメ                   |       7 | 密着！アイドル生活 シーズン7                                 | 558298237.2727 |
| アニメ                   |       8 | 密着！アイドル生活 シーズン18                                | 545230207.3750 |
| アニメ                   |       9 | 密着！アイドル生活 シーズン2                                 | 526001112.0000 |
| アニメ                   |      10 | 密着！アイドル生活 シーズン11                                | 473737782.3333 |




  <br></text>

</details>
<br>

## <li>反省</li>

  - エピソードの公開非公開を選択するカラムが必要
  - テーブル名やカラム名の命名規則が確立されていない
  - `metrics_marker_function.function_content`にはおそらくパラメーターしか入らない為、text型では無く新たにテーブルを作成して、そこにパラメーターを格納するべきだった。
  - メインジャンルカラムを作成した事による欠陥。
  - SQLスタイルガイドに基づく命名規則の理解不足、特に、集合名詞、複数形。

<ol>